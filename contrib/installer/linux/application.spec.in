Summary: @COMMANDLINE@
Name: @COMMANDLINE@
Version: @CMAKE_PROJECT_VERSION@
Release: 1
Source: https://github.com/vengi-voxel/vengi/archive/refs/tags/v%{version}.tar.gz
URL: https://vengi-voxel.de/
License: MIT
Group: Applications/Multimedia
BuildRoot: %{_tmppath}/%{name}-%{version}-buildroot
Prefix: %{_prefix}
Vendor: Martin Gerhardy
Requires: SDL2 freetype libjpeg binutils libasan libubsan libcurl

%define debug_package %{nil}

%description
@DESCRIPTION@

%prep
%setup -q

%build
mkdir build
cd build
cmake .. -GNinja -DCMAKE_BUILD_TYPE=Release -DCMAKE_UNITY_BUILD=On -DUSE_SANITIZERS=ON
cmake --build . --target @NAME@

%install
rm -rf $RPM_BUILD_ROOT
cmake --install ./build --component @NAME@ --prefix $RPM_BUILD_ROOT%{prefix}

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
/usr/bin/*
/usr/share/man/man1/*
/usr/share/applications/*
/usr/share/@COMMANDLINE@/*
/usr/share/icons/*
%if %([ -d /usr/share/metainfo ] && echo 1 || echo 0)
/usr/share/metainfo/*
%endif

%changelog
* Mon Jan 27 2025 Martin Gerhardy <martin.gerhardy@gmail.com>
- First spec file version.

# dnf install epel-release
# dnf config-manager --set-enabled crb
# dnf install SDL2-devel freetype-devel libjpeg-devel binutils-devel make cmake gcc g++ libasan libubsan ninja-build libcurl-devel
# dnf install rpm-devel
# mkdir -p ~/rpmbuild/{BUILD,RPMS,SOURCES,SPECS,SRPMS}
# cp build/src/tools/*/vengi-*.spec ~/rpmbuild/SPECS
# git archive --output=/root/rpmbuild/SOURCES/v@CMAKE_PROJECT_VERSION@.tar.gz --format=tar --prefix=@COMMANDLINE@-@CMAKE_PROJECT_VERSION@/ HEAD .
# rpmbuild -ba ~/rpmbuild/SPECS/<specfile>.spec
# end of file
